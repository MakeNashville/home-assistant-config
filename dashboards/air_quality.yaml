title: 3D Print Air Quality
views:
  - title: Air Quality
    path: overview
    icon: mdi:air-filter
    cards:

      # â”€â”€ Danger / warning banner (hidden when Good or Moderate) â”€â”€â”€â”€â”€â”€â”€
      - type: conditional
        conditions:
          - condition: or
            conditions:
              - condition: state
                entity: sensor.air_quality_overall_status
                state: Poor
              - condition: state
                entity: sensor.air_quality_overall_status
                state: Dangerous
        card:
          type: markdown
          content: >
            {% set st = states('sensor.air_quality_overall_status') %}
            {% set co2  = states('sensor.air_quality_carbon_dioxide') | int(0) %}
            {% set voc  = states('sensor.air_quality_voc_index') | int(0) %}
            {% set nox  = states('sensor.air_quality_nox_index') | int(0) %}
            {% set pm25 = states('sensor.air_quality_pm2_5') | float(0) %}

            {% if st == 'Dangerous' %}## â›” DANGEROUS AIR QUALITY â€” VENTILATE IMMEDIATELY
            {% else %}## âš ï¸ POOR AIR QUALITY â€” Ventilation Recommended
            {% endif %}
            {% if co2  > 1200 %}â€¢ COâ‚‚ at **{{ co2 }} ppm** â€” unhealthy above 1,200 ppm (impairs cognition)
            {% endif %}{% if voc  > 200 %}â€¢ VOC Index at **{{ voc }}** â€” unhealthy above 200 (active emissions present)
            {% endif %}{% if nox  > 150 %}â€¢ NOx Index at **{{ nox }}** â€” investigate combustion or outdoor source
            {% endif %}{% if pm25 > 35.4 %}â€¢ PM2.5 at **{{ pm25 | round(1) }} Âµg/mÂ³** â€” EPA unhealthy above 35.4 Âµg/mÂ³
            {% endif %}

      # â”€â”€ Status header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: markdown
        content: >
          {% set st = states('sensor.air_quality_overall_status') %}
          {% set icon = 'ðŸŸ¢' if st == 'Good' else 'ðŸŸ¡' if st == 'Moderate' else 'ðŸŸ ' if st == 'Poor' else 'ðŸ”´' %}
          ## {{ icon }} 3D Print Room â€” Air Quality {{ st }}
          **Updated {{ now().strftime('%-I:%M %p') }}**

      # â”€â”€ Primary pollutant gauges â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: grid
        columns: 4
        square: false
        cards:
          - type: gauge
            entity: sensor.air_quality_carbon_dioxide
            name: "COâ‚‚ Â· Poor >1,200 ppm"
            unit: ppm
            min: 400
            max: 2000
            needle: true
            severity:
              green: 400
              yellow: 800
              red: 1200

          - type: gauge
            entity: sensor.air_quality_voc_index
            name: "VOC Index Â· Poor >200"
            unit: index
            min: 0
            max: 400
            needle: true
            severity:
              green: 0
              yellow: 150
              red: 250

          - type: gauge
            entity: sensor.air_quality_nox_index
            name: "NOx Index Â· Poor >150"
            unit: index
            min: 0
            max: 300
            needle: true
            severity:
              green: 0
              yellow: 50
              red: 150

          - type: gauge
            entity: sensor.air_quality_pm2_5
            name: "PM2.5 Â· Poor >35.4 Âµg/mÂ³"
            unit: Âµg/mÂ³
            min: 0
            max: 150
            needle: true
            severity:
              green: 0
              yellow: 12
              red: 35

      # â”€â”€ Secondary readings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: grid
        columns: 5
        square: false
        cards:
          - type: gauge
            entity: sensor.air_quality_pm1
            name: "PM1 Â· High >15 Âµg/mÂ³"
            unit: Âµg/mÂ³
            min: 0
            max: 50
            needle: true
            severity:
              green: 0
              yellow: 5
              red: 15

          - type: gauge
            entity: sensor.air_quality_pm10
            name: "PM10 Â· High >154 Âµg/mÂ³"
            unit: Âµg/mÂ³
            min: 0
            max: 200
            needle: true
            severity:
              green: 0
              yellow: 54
              red: 154

          - type: gauge
            entity: sensor.air_quality_pm0_3
            name: "PM0.3 Ultrafine Particles"
            unit: particles/dL
            min: 0
            max: 8000
            needle: true
            severity:
              green: 0
              yellow: 500
              red: 1500

          - type: gauge
            entity: sensor.air_quality_temperature
            name: Temperature
            min: 60
            max: 95
            needle: true
            severity:
              green: 65
              yellow: 80
              red: 88

          - type: gauge
            entity: sensor.air_quality_humidity
            name: Humidity
            unit: "%"
            min: 0
            max: 100
            needle: true
            severity:
              green: 30
              yellow: 60
              red: 70

      # â”€â”€ Education cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: grid
        columns: 4
        square: false
        cards:

          - type: markdown
            content: |
              {% set v = states('sensor.air_quality_carbon_dioxide') | int(0) %}
              {% if v < 800 %}### ðŸŸ¢ COâ‚‚ â€” {{ v }} ppm â€” Good
              {% elif v < 1200 %}### ðŸŸ¡ COâ‚‚ â€” {{ v }} ppm â€” Moderate
              {% elif v < 1500 %}### ðŸŸ  COâ‚‚ â€” {{ v }} ppm â€” Poor
              {% else %}### ðŸ”´ COâ‚‚ â€” {{ v }} ppm â€” Dangerous{% endif %}

              {% if v < 800 %}Fresh, well-ventilated air. No action needed.
              {% elif v < 1000 %}Mild stuffiness. Open a door or window.
              {% elif v < 1200 %}Ventilate now â€” cognitive effects start around 1,000 ppm.
              {% elif v < 1500 %}Headaches and fatigue likely. Ventilate immediately.
              {% else %}Severe impairment risk. Leave area and ventilate.{% endif %}

              **3D printing context:** COâ‚‚ doesn't come from printers â€” it signals poor ventilation. The same stale air that traps COâ‚‚ concentrates the VOCs and particles your printers emit. Source: ASHRAE 62.1, NIOSH.

          - type: markdown
            content: |
              {% set v = states('sensor.air_quality_voc_index') | int(0) %}
              {% if v < 150 %}### ðŸŸ¢ VOC Index â€” {{ v }} â€” Good
              {% elif v < 200 %}### ðŸŸ¡ VOC Index â€” {{ v }} â€” Moderate
              {% elif v < 300 %}### ðŸŸ  VOC Index â€” {{ v }} â€” Poor
              {% else %}### ðŸ”´ VOC Index â€” {{ v }} â€” Dangerous{% endif %}

              {% if v < 100 %}Cleaner than typical indoor baseline (100 = average room).
              {% elif v < 150 %}Normal indoor background. No action needed.
              {% elif v < 200 %}Elevated VOCs. Increase ventilation.
              {% elif v < 300 %}Active source present. Ventilate and identify source.
              {% else %}Leave area and ventilate immediately.{% endif %}

              **Emissions by material:** PLA (low), PETG (medium), ABS/ASA (high, 150â€“300+), Nylon (highest). Enclosures with activated carbon filtration cut VOCs by 90%+. Source: Sensirion VOC Index application note.

          - type: markdown
            content: |
              {% set v = states('sensor.air_quality_nox_index') | int(0) %}
              {% if v < 50 %}### ðŸŸ¢ NOx Index â€” {{ v }} â€” Good
              {% elif v < 150 %}### ðŸŸ¡ NOx Index â€” {{ v }} â€” Moderate
              {% elif v < 250 %}### ðŸŸ  NOx Index â€” {{ v }} â€” Poor
              {% else %}### ðŸ”´ NOx Index â€” {{ v }} â€” Dangerous{% endif %}

              {% if v < 50 %}Normal indoor air quality.
              {% elif v < 150 %}Mildly elevated. Possible outdoor pollution or combustion nearby.
              {% elif v < 250 %}Respiratory irritation risk. Investigate and ventilate.
              {% else %}Leave the area â€” significant combustion or pollution source nearby.{% endif %}

              **3D printing context:** FDM printers produce minimal NOx at normal temps. Spikes indicate an external source: combustion, diesel, laser cutters, or resin printers. Source: Sensirion NOx Index application note, WHO.

          - type: markdown
            content: |
              {% set v = states('sensor.air_quality_pm2_5') | float(0) %}
              {% if v < 12 %}### ðŸŸ¢ PM2.5 â€” {{ v | round(1) }} Âµg/mÂ³ â€” Good
              {% elif v < 35.4 %}### ðŸŸ¡ PM2.5 â€” {{ v | round(1) }} Âµg/mÂ³ â€” Moderate
              {% elif v < 55.4 %}### ðŸŸ  PM2.5 â€” {{ v | round(1) }} Âµg/mÂ³ â€” Unhealthy (sensitive groups)
              {% elif v < 150.4 %}### ðŸ”´ PM2.5 â€” {{ v | round(1) }} Âµg/mÂ³ â€” Unhealthy
              {% else %}### â›” PM2.5 â€” {{ v | round(1) }} Âµg/mÂ³ â€” Hazardous{% endif %}

              {% if v < 12 %}EPA AQI: Good. Safe for all individuals.
              {% elif v < 35.4 %}Sensitive individuals should reduce time in area.
              {% elif v < 55.4 %}Reduce exposure. Improve filtration or ventilation.
              {% elif v < 150.4 %}All individuals at risk. Ventilate immediately.
              {% else %}Evacuate. Hazardous to all.{% endif %}

              **Emissions by material:** PLA (20â€“100 Âµg/mÂ³), PETG (30â€“100), ABS (50â€“200+), Nylon (200+). Particles penetrate deep into lungs â€” HEPA-filtered enclosures reduce emissions 90%+. Source: EPA AQI, peer-reviewed FDM emission studies.

      # â”€â”€ 24-hour history â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: grid
        columns: 2
        square: false
        cards:
          - type: history-graph
            title: COâ‚‚ â€” 24h (ppm)
            hours_to_show: 24
            entities:
              - entity: sensor.air_quality_carbon_dioxide
                name: COâ‚‚

          - type: history-graph
            title: VOC & NOx Index â€” 24h
            hours_to_show: 24
            entities:
              - entity: sensor.air_quality_voc_index
                name: VOC Index
              - entity: sensor.air_quality_nox_index
                name: NOx Index

          - type: history-graph
            title: Particulates â€” 24h (Âµg/mÂ³)
            hours_to_show: 24
            entities:
              - entity: sensor.air_quality_pm2_5
                name: PM2.5
              - entity: sensor.air_quality_pm1
                name: PM1
              - entity: sensor.air_quality_pm10
                name: PM10

          - type: history-graph
            title: PM0.3 Ultrafine Count â€” 24h (#/dL)
            hours_to_show: 24
            entities:
              - entity: sensor.air_quality_pm0_3
                name: PM0.3

      - type: history-graph
        title: Temperature & Humidity â€” 24h
        hours_to_show: 24
        entities:
          - entity: sensor.air_quality_temperature
            name: Temperature
          - entity: sensor.air_quality_humidity
            name: Humidity

      # â”€â”€ Printer context â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: glance
        title: Printer Status
        columns: 6
        entities:
          - entity: sensor.kiwi_print_status
            name: Kiwi
          - entity: sensor.mango_print_status
            name: Mango
          - entity: sensor.papaya_print_status
            name: Papaya
          - entity: sensor.strawberry_print_status
            name: Strawberry
          - entity: sensor.huckleberry_print_status
            name: Huckleberry
          - entity: sensor.pineapple_print_status
            name: Pineapple
